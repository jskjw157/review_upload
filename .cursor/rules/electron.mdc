---
description: Electron ë°ìŠ¤í¬í†± ì•± ê°œë°œ ê°€ì´ë“œë¼ì¸ - Main/Renderer í”„ë¡œì„¸ìŠ¤ ì•„í‚¤í…ì²˜ ë° IPC í†µì‹  íŒ¨í„´
globs: ["src/main/**/*.ts", "src/renderer/**/*.ts", "src/types/**/*.ts"]
alwaysApply: false
---

# Electron ê°œë°œ ê°€ì´ë“œë¼ì¸

## ğŸ—ï¸ ì•„í‚¤í…ì²˜ ì›ì¹™

### Main Process (src/main/)
- **ì—­í• **: ì‹œìŠ¤í…œ ë¦¬ì†ŒìŠ¤ ì ‘ê·¼, íŒŒì¼ ì‹œìŠ¤í…œ, ë„¤íŠ¸ì›Œí¬ ìš”ì²­, ì°½ ê´€ë¦¬
- **ë³´ì•ˆ**: ì ˆëŒ€ë¡œ ì‚¬ìš©ì ì…ë ¥ì„ ì§ì ‘ ì‹¤í–‰í•˜ì§€ ì•ŠìŒ
- **ë¦¬ì†ŒìŠ¤**: ë¬´ê±°ìš´ ì—°ì‚°ì€ Worker Threadë¡œ ë¶„ë¦¬ ê³ ë ¤

### Renderer Process (src/renderer/)
- **ì—­í• **: UI ë Œë”ë§, ì‚¬ìš©ì ìƒí˜¸ì‘ìš©
- **ì œí•œ**: Node.js API ì§ì ‘ ì ‘ê·¼ ë¶ˆê°€ (contextIsolation: true)
- **í†µì‹ **: preload.tsë¥¼ í†µí•œ contextBridge ì‚¬ìš©

### Preload Script (src/main/preload.ts)
- **ì—­í• **: Mainê³¼ Renderer ê°„ì˜ ì•ˆì „í•œ ë¸Œë¦¿ì§€
- **íŒ¨í„´**: ìµœì†Œí•œì˜ APIë§Œ ë…¸ì¶œ

## ğŸ” ë³´ì•ˆ ë² ìŠ¤íŠ¸ í”„ë™í‹°ìŠ¤

```typescript
// âœ… GOOD: contextBridgeë¥¼ í†µí•œ ì•ˆì „í•œ API ë…¸ì¶œ
contextBridge.exposeInMainWorld('api', {
  submitReview: (data: ReviewInput) => ipcRenderer.invoke('review:submit', data),
  onProgress: (callback: (progress: number) => void) => {
    ipcRenderer.on('upload:progress', (_, progress) => callback(progress));
  },
});

// âŒ BAD: ì „ì²´ ipcRenderer ë…¸ì¶œ
contextBridge.exposeInMainWorld('ipcRenderer', ipcRenderer);
```

## ğŸ“¡ IPC í†µì‹  íŒ¨í„´

### Handle/Invoke íŒ¨í„´ (ì–‘ë°©í–¥, Promise ê¸°ë°˜)
```typescript
// Main Process
ipcMain.handle('channel-name', async (event, payload: PayloadType) => {
  try {
    const result = await performOperation(payload);
    return { success: true, data: result };
  } catch (error) {
    return { success: false, error: error.message };
  }
});

// Renderer Process (via preload)
const result = await window.api.channelName(payload);
```

### Send/On íŒ¨í„´ (ë‹¨ë°©í–¥, ì´ë²¤íŠ¸ ê¸°ë°˜)
```typescript
// Main â†’ Renderer (ì§„í–‰ë¥  ì—…ë°ì´íŠ¸ ë“±)
mainWindow.webContents.send('upload:progress', progress);

// Rendererì—ì„œ ìˆ˜ì‹  (preloadë¥¼ í†µí•´)
ipcRenderer.on('upload:progress', (_, progress) => callback(progress));
```

## ğŸ“ íŒŒì¼ êµ¬ì¡° ì»¨ë²¤ì…˜

```
src/
â”œâ”€â”€ main/                 # Main Process
â”‚   â”œâ”€â”€ main.ts          # ì•± ì§„ì…ì , ì°½ ê´€ë¦¬
â”‚   â”œâ”€â”€ preload.ts       # contextBridge ì •ì˜
â”‚   â””â”€â”€ services/        # ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
â”‚       â”œâ”€â”€ auth.ts      # ì¸ì¦ ì„œë¹„ìŠ¤
â”‚       â””â”€â”€ review.ts    # ë¦¬ë·° ì—…ë¡œë“œ ì„œë¹„ìŠ¤
â”œâ”€â”€ renderer/            # Renderer Process
â”‚   â”œâ”€â”€ main.ts         # UI ì§„ì…ì 
â”‚   â””â”€â”€ services/       # UI ê´€ë ¨ ì„œë¹„ìŠ¤
â””â”€â”€ types/              # ê³µìœ  íƒ€ì… ì •ì˜
    â”œâ”€â”€ global.d.ts     # window.api íƒ€ì…
    â””â”€â”€ ipc.ts          # IPC í˜ì´ë¡œë“œ íƒ€ì…
```

## âš¡ ì„±ëŠ¥ ìµœì í™”

### ì°½ ìƒì„± ìµœì í™”
```typescript
// ì°½ì„ ìˆ¨ê¸´ ìƒíƒœë¡œ ìƒì„± í›„ ready-to-showì—ì„œ í‘œì‹œ
mainWindow = new BrowserWindow({
  show: false,  // ì´ˆê¸° ìˆ¨ê¹€
  // ...
});

mainWindow.once('ready-to-show', () => {
  mainWindow?.show();
});
```

### ëŒ€ìš©ëŸ‰ ë°ì´í„° ì „ì†¡
```typescript
// âŒ BAD: í° ë°ì´í„°ë¥¼ ì§ì ‘ ì „ì†¡
ipcMain.handle('upload', (_, hugeBuffer: Buffer) => { ... });

// âœ… GOOD: íŒŒì¼ ê²½ë¡œ ì „ë‹¬ ë˜ëŠ” ìŠ¤íŠ¸ë¦¬ë°
ipcMain.handle('upload', (_, filePath: string) => {
  const stream = fs.createReadStream(filePath);
  // ìŠ¤íŠ¸ë¦¬ë° ì²˜ë¦¬
});
```

## ğŸ›¡ï¸ íƒ€ì… ì•ˆì „í•œ IPC

```typescript
// types/ipc.ts - ëª¨ë“  IPC ì±„ë„ê³¼ í˜ì´ë¡œë“œ ì •ì˜
export interface IpcChannels {
  'auth:exchange': {
    request: AuthCodePayload;
    response: TokenResponse;
  };
  'review:submit': {
    request: ReviewRequestPayload;
    response: ReviewResponse;
  };
}

// íƒ€ì… ì•ˆì „í•œ invoke ë˜í¼
type Channel = keyof IpcChannels;
async function typedInvoke<C extends Channel>(
  channel: C,
  payload: IpcChannels[C]['request']
): Promise<IpcChannels[C]['response']> {
  return ipcRenderer.invoke(channel, payload);
}
```

## ğŸ”§ ê°œë°œ í™˜ê²½ ì„¤ì •

```typescript
// ê°œë°œ/í”„ë¡œë•ì…˜ í™˜ê²½ ë¶„ê¸°
const isDev = process.env.NODE_ENV === 'development';

if (isDev && devServerUrl) {
  await window.loadURL(devServerUrl);
  window.webContents.openDevTools({ mode: 'detach' });
} else {
  await window.loadFile(path.join(__dirname, 'index.html'));
}
```

## âš ï¸ ì¼ë°˜ì ì¸ ì‹¤ìˆ˜ ë°©ì§€

1. **Remote ëª¨ë“ˆ ì‚¬ìš© ê¸ˆì§€**: ë³´ì•ˆ ì·¨ì•½ì  ë° ì„±ëŠ¥ ì €í•˜
2. **nodeIntegration: true ê¸ˆì§€**: ë³´ì•ˆ ìœ„í—˜
3. **sync IPC ë©”ì„œë“œ ì§€ì–‘**: `sendSync` ëŒ€ì‹  `invoke` ì‚¬ìš©
4. **ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ ì£¼ì˜**: ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì •ë¦¬

```typescript
// ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì •ë¦¬
const cleanup = () => {
  ipcRenderer.removeAllListeners('upload:progress');
};
// ì»´í¬ë„ŒíŠ¸ ì–¸ë§ˆìš´íŠ¸ ì‹œ í˜¸ì¶œ
```
